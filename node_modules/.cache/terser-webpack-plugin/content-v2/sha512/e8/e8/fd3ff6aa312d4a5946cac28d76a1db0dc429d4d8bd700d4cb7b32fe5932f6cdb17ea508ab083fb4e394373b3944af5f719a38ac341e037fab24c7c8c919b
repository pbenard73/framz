{"code":"!function(e,t){for(var s in t)e[s]=t[s]}(exports,function(e){var t={};function s(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,\"a\",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p=\"\",s(s.s=13)}([function(e,t){e.exports=require(\"underscore\")},function(e,t){e.exports=require(\"express\")},function(e,t){e.exports=require(\"sequelize\")},function(e,t){throw new Error(\"Module build failed (from ./node_modules/babel-loader/lib/index.js):\\nSyntaxError: /home/patrick/Workspace/framz/src/core/helpers/required.js: Unexpected token, expected \\\";\\\" (1:69)\\n\\n\u001b[0m\u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 1 | \u001b[39m\u001b[36mexport\u001b[39m \u001b[36mdefault\u001b[39m param \u001b[33m=>\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m`Parameter '${param}' is required`\u001b[39m))\u001b[0m\\n\u001b[0m \u001b[90m   | \u001b[39m                                                                     \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\u001b[0m\\n\u001b[0m \u001b[90m 2 | \u001b[39m\u001b[0m\\n    at Parser._raise (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:766:17)\\n    at Parser.raiseWithData (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:759:17)\\n    at Parser.raise (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:753:17)\\n    at Parser.unexpected (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:8966:16)\\n    at Parser.semicolon (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:8948:40)\\n    at Parser.parseExportDefaultExpression (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:12621:12)\\n    at Parser.parseExport (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:12530:31)\\n    at Parser.parseStatementContent (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:11537:27)\\n    at Parser.parseStatement (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:11431:17)\\n    at Parser.parseBlockOrModuleBlockBody (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:12013:25)\\n    at Parser.parseBlockBody (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:11999:10)\\n    at Parser.parseTopLevel (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:11362:10)\\n    at Parser.parse (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:13045:10)\\n    at parse (/home/patrick/Workspace/framz/node_modules/@babel/parser/lib/index.js:13098:38)\\n    at parser (/home/patrick/Workspace/framz/node_modules/@babel/core/lib/parser/index.js:54:34)\\n    at parser.next (<anonymous>)\\n    at normalizeFile (/home/patrick/Workspace/framz/node_modules/@babel/core/lib/transformation/normalize-file.js:99:38)\\n    at normalizeFile.next (<anonymous>)\\n    at run (/home/patrick/Workspace/framz/node_modules/@babel/core/lib/transformation/index.js:31:50)\\n    at run.next (<anonymous>)\\n    at Function.transform (/home/patrick/Workspace/framz/node_modules/@babel/core/lib/transform.js:27:41)\\n    at transform.next (<anonymous>)\\n    at step (/home/patrick/Workspace/framz/node_modules/gensync/index.js:254:32)\\n    at /home/patrick/Workspace/framz/node_modules/gensync/index.js:266:13\\n    at async.call.result.err.err (/home/patrick/Workspace/framz/node_modules/gensync/index.js:216:11)\")},function(e,t){e.exports=require(\"express-session\")},function(e,t){e.exports=require(\"cookie-parser\")},function(e,t){e.exports=require(\"morgan\")},function(e,t){e.exports=require(\"compression\")},function(e,t){e.exports=require(\"redis\")},function(e,t){e.exports=require(\"connect-redis\")},function(e,t){e.exports=require(\"http\")},function(e,t){e.exports=require(\"path\")},function(e,t){e.exports=require(\"socket.io\")},function(e,t,s){\"use strict\";s.r(t),s.d(t,\"App\",(function(){return $})),s.d(t,\"database\",(function(){return J})),s.d(t,\"express\",(function(){return K}));var r=s(1),n=s.n(r),i=(s(11),s(5)),o=s.n(i),a=s(6),c=s.n(a),u=s(0),l=s.n(u),d=s(7),p=s.n(d),h={use:function(...e){return this.uses.push(e),this},get:function(...e){return this.routers.push([\"get\",e]),this},addRouter:function(...e){return this.routers.push([\"router\",e]),this},addPublic(...e){return this.publicFolders.push(e),this}},f=s(4),m=s.n(f),b=s(8),k=s.n(b),g=s(9),x=s.n(g),y={setSessionConfig:function(e,t,s){return void 0===t?this.config.session.config=e:this.config.session=void 0!==s?{type:e,config:t,redisConfig:s}:{type:e},this},init:function(){if(!0===this.config.useSession){let e=this.config.session.config;if(\"redis\"===this.config.session){e={store:new(x()(m.a))({client:k.a.createClient(this.config.session.redisConfig)}),...this.config.session.config}}this.app.use(m()(e))}}},v=s(2),j=s.n(v);function O(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var P=class{constructor(){O(this,\"name\",void 0),O(this,\"fields\",{}),O(this,\"translatedFields\",[]),O(this,\"createForm\",null),O(this,\"editForm\",null),O(this,\"softDeletable\",!1),O(this,\"virtualFields\",{}),O(this,\"links\",{}),O(this,\"hooks\",{})}build(e){let t={};return l.a.each(Object.keys(this.fields),e=>{t[e]={type:this.fieldMapping(e),uniq:e.uniq}}),e.define(this.name,t,{tableName:this.name})}fieldMapping(e){switch(e.type){case\"text\":return j.a.STRING(void 0!==e.length?e.length:250);case\"boolean\":return j.a.BOOLEAN;default:return j.a.STRING(void 0!==e.length?e.length:250)}}};function _(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var S=class extends P{constructor(...e){super(...e),_(this,\"name\",\"user\"),_(this,\"fields\",{username:{type:\"text\",uniq:!0,length:250},password:{type:\"text\",length:500}})}};function w(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var W=new class{constructor(){w(this,\"databases\",{main:{database:null,models:{}}}),w(this,\"models\",{user:S})}getModel(e,t=\"main\"){return this.databases[t].models[e]}init(e){this.databases.main.database=new j.a({...e.config.database,dialect:\"postgres\"}),this.processModels(\"main\"),this.databases.main.database.sync()}processModels(e){const t=this.databases[e].database;l.a.each(Object.keys(this.models),s=>{this.databases[e].models[s]=(new this.models[s]).build(t)})}},z={setDatabaseConfig:function(e){return this.config.database=e,this},addModel:function(e){return this.models.push(e),this},addModels:function(...e){return this.models=[...this.models,...e],this},init:function(){\"object\"==typeof this.config.database&&W.init(this)}},M={setSocketConfig:function(e){return this.config.socket=void 0===e?{}:e,this},useSocket:function(e=!0,t=!1){return this.config.useSocket=e,this.config.useSessionSocket=t,this},addRooms:function(...e){return this.sockets=[...this.sockets,...e],this},initSocket:function(e){return this.io=e,console.log(\"Jinit le io\"),this}};var E=new class{constructor(){var e,t,s;s={},(t=\"modules\")in(e=this)?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}addModule(e){}};var q=new class{constructor(){var e,t,s;s={},(t=\"website\")in(e=this)?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}addWebsite(e){}},N={addWebsite:function(e){return q.addWebsite(e),this},addWebsites:function(...e){return l.a.each(e,e=>this.addWebsite(e)),this},addModule:function(e){return E.addModule(e),this},addModules:function(...e){return l.a.each(e,e=>this.addModule(e)),this},init:function(){}},R=s(3),C=s.n(R);function A(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var F=(new class{constructor(){A(this,\"pool\",{ROLE_SUPER_ADMIN:{ROLE_ADMIN:{ROLE_USER:{ROLE_ANONYMOUS:ROLE_ANONYMOUS}}}}),A(this,\"flatPool\",{})}setHierarchy(e){this.pool=e}addRole(e=C()(\"roleName\"),t=null){if(null===t)this.pool[e.toUppercase()]={};else{if(void 0===this.pool[t.toUppercase()])throw new Error(`Role ${t} was not found in hierarchy`);this.pool[t.toUppercase()].roleName={}}}prepareHierarchy(){const e=(t,s)=>{const r=Object.keys(s);let n=[];return l.a.each(r,t=>{const r=e(t,s[t]);flatPool[t]=r,n=[...n,...r]}),n};l.a.each(Object.keys(this.pool),t=>{flatPool[t]=e(t,this.pool[t])})}isGranted(e,t){return\"ROLE_ANONYMOUS\"===t||void 0!==e.session&&void 0!==e.session.user&&void 0!==this.flatPool[t]&&-1!==this.flatPool[t].indexOf(e.session.user.acl)}})(),U={setAclHierarchy:function(e=C()(\"hierarchy\")){return F.setHierarchy(e),this},addAclRole:function(e=C()(\"roleName\"),t=null){return F.addRole(e,t),this},init:function(){F.prepareHierarchy(),console.log(F.flatPool)}},L=s(10);let D;var B,I=function(){if(B=function(e){var t=parseInt(e,10);if(isNaN(t))return e;if(t>=0)return t;return!1}(process.env.PORT||\"3000\"),this.app.set(\"port\",B),D=L.createServer(this.app),!0===this.config.useSocket){const e=s(12)(D);this.initSocket(e)}D.listen(B),D.on(\"error\",H),D.on(\"listening\",T)};function T(){var e=D.address(),t=\"string\"==typeof e?\"pipe \"+e:\"port \"+e.port;console.log(\"Listening on \"+t)}function H(e){if(\"listen\"!==e.syscall)throw e;var t=\"string\"==typeof B?\"Pipe \"+B:\"Port \"+B;switch(e.code){case\"EACCES\":console.error(t+\" requires elevated privileges\"),process.exit(1);break;case\"EADDRINUSE\":console.error(t+\" is already in use\"),process.exit(1);break;default:throw e}}function G(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Y(...e){const t=[\"build\"];l.a.each(e,e=>{l.a.each(Object.keys(e),s=>{\"init\"===s?this.inits.push(e[s]):-1===t.indexOf(s)&&(this[s]=(...t)=>e[s].call(this,...t))})})}const $=new class{constructor(){G(this,\"app\",n()()),G(this,\"uses\",[]),G(this,\"routers\",[]),G(this,\"publicFolders\",[]),G(this,\"models\",[]),G(this,\"sockets\",[]),G(this,\"io\",null),G(this,\"config\",{session:{type:null,config:{},redisConfig:void 0},socket:{}}),G(this,\"defaultConfig\",{useCors:!1,statics:{},useSession:!0,useCompression:!0,useSocket:!1,useSessionSocket:!1}),G(this,\"inits\",[]),Y.call(this,y,h,N,z,M,U)}setConfig(e){return this}run(){this.config={...this.defaultConfig,...this.config},this.app.set(\"trust proxy\",1),l.a.each(this.inits,e=>{e.call(this)}),this.app.use(c()(\"dev\")),this.app.use(n.a.json()),this.use(n.a.urlencoded({extended:!1})),this.use(o()()),this.use(p()()),l.a.each(this.publicFolders,e=>{1===e.length?this.app.use(n.a.static(...e)):2===e.length&&this.app.use(e[0],n.a.static(e[1]))}),l.a.each(this.uses,e=>{this.app.use(...e)}),l.a.each(this.routers,e=>{let[t,s]=e;this.app[\"router\"===t?\"use\":t](...s)}),I.call(this)}},J=W,K=n.a}]));","extractedComments":[]}