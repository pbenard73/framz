!function(e,t){for(var n in t)e[n]=t[n]}(exports,function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=28)}([function(e,t){e.exports=require("@babel/runtime/helpers/defineProperty")},function(e,t){e.exports=require("underscore")},function(e,t){e.exports=require("@babel/runtime/helpers/classCallCheck")},function(e,t){e.exports=require("@babel/runtime/helpers/createClass")},function(e,t){e.exports=require("@babel/runtime/helpers/toConsumableArray")},function(e,t){e.exports=require("sequelize")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("@babel/runtime/regenerator")},function(e,t){e.exports=require("@babel/runtime/helpers/assertThisInitialized")},function(e,t){e.exports=require("@babel/runtime/helpers/getPrototypeOf")},function(e,t){e.exports=require("@babel/runtime/helpers/asyncToGenerator")},function(e,t){e.exports=require("@babel/runtime/helpers/inherits")},function(e,t){e.exports=require("@babel/runtime/helpers/possibleConstructorReturn")},function(e,t){e.exports=require("http-errors")},function(e,t){e.exports=require("@babel/runtime/helpers/slicedToArray")},function(e,t){e.exports=require("express-session")},function(e,t){e.exports=require("@babel/runtime/helpers/toArray")},function(e,t){e.exports=require("cookie-parser")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("compression")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("socket.io")},function(e,t){e.exports=require("redis")},function(e,t){e.exports=require("connect-redis")},function(e,t){e.exports=require("@babel/runtime/helpers/classPrivateFieldGet")},function(e,t){e.exports=require("@babel/runtime/helpers/classPrivateFieldSet")},function(e,t){e.exports=require("@babel/runtime/helpers/typeof")},function(e,t){e.exports=require("crypto")},function(e,t,n){"use strict";n.r(t),n.d(t,"App",(function(){return _e})),n.d(t,"Repository",(function(){return Le})),n.d(t,"acl",(function(){return Fe})),n.d(t,"aclManager",(function(){return Be})),n.d(t,"cache",(function(){return He})),n.d(t,"crypter",(function(){return ze})),n.d(t,"database",(function(){return Ge})),n.d(t,"listener",(function(){return We})),n.d(t,"socket",(function(){return Ye})),n.d(t,"Model",(function(){return Je})),n.d(t,"Module",(function(){return Ke})),n.d(t,"createError",(function(){return Qe})),n.d(t,"express",(function(){return Ve})),n.d(t,"Router",(function(){return Xe}));var r,o,i=n(2),s=n.n(i),u=n(3),a=n.n(u),c=function(){function e(t,n,r){s()(this,e),this.req=t,this.Model=n,this.data=r}return a()(e,[{key:"prepareOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0===e.raw&&(e.raw=!0),e}},{key:"create",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return new Promise((function(t,r){var o;(o=e.Model).create.apply(o,n).then((function(e){return t(e)})).catch((function(e){return r(e)}))}))}},{key:"createBulk",value:function(){}},{key:"paginate",value:function(e){return this.findAll()}},{key:"findAll",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(n,r){e.Model.findAll(e.prepareOptions(t)).then((function(e){return n(e)})).catch((function(e){return r(e)}))}))}},{key:"findById",value:function(e){var t=this;return new Promise((function(n,r){t.Model.findOne(t.prepareOptions({where:e})).then((function(e){return n(e)})).catch((function(e){return r(e)}))}))}},{key:"findOne",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(n,r){e.Model.findOne(e.prepareOptions(t)).then((function(e){return n(e)})).catch((function(e){return r(e)}))}))}},{key:"updateById",value:function(e,t){}},{key:"deleteById",value:function(e){}},{key:"deleteAll",value:function(e){}}]),e}(),l=n(16),f=n.n(l),h=n(4),p=n.n(h),d=n(0),v=n.n(d),y=n(6),g=n.n(y),b=n(17),m=n.n(b),k=n(18),w=n.n(k),O=n(1),x=n.n(O),P=n(19),S=n.n(P),j=n(20),A=n(21),R=n.n(A),M=function(){if(o=function(e){var t=parseInt(e,10);if(isNaN(t))return e;if(t>=0)return t;return!1}(process.env.PORT||this.config.port),this.app.set("port",o),r=j.createServer(this.app),!0===this.config.useSocket){var e=R()(r);this.initSocket(e)}r.listen(o),r.on("error",q),r.on("listening",E)};function E(){var e=r.address(),t="string"==typeof e?"pipe "+e:"port "+e.port;console.log("Listening on "+t)}function q(e){if("listen"!==e.syscall)throw e;var t="string"==typeof o?"Pipe "+o:"Port "+o;switch(e.code){case"EACCES":console.error(t+" requires elevated privileges"),process.exit(1);break;case"EADDRINUSE":console.error(t+" is already in use"),process.exit(1);break;default:throw e}}var C={setPort:function(e){return this.config.port=e,this},use:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.uses.push(t),this},get:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.routers.push(["get"].concat(t)),this},post:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.routers.push(["post"].concat(t)),this},put:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.routers.push(["put"].concat(t)),this},delete:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.routers.push(["delete"].concat(t)),this},addRouter:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.routers.push(["router"].concat(t)),this},addPublic:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.publicFolders.push(t),this}},D=n(15),U=n.n(D),N=n(22),T=n.n(N),I=n(23),_=n.n(I),L=n(24),F=n.n(L),B=n(25),H=n.n(B),z=n(27),G=new WeakMap,W=new(function(){function e(){s()(this,e),G.set(this,{writable:!0,value:null})}return a()(e,[{key:"setSecret",value:function(e){H()(this,G,e)}},{key:"encrypt",value:function(e){return z.createHmac("sha256",F()(this,G)).update(e).digest("hex")}}]),e}());function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var J={useSession:function(e){return"string"==typeof e?(this.config.useSession=!0,this.config.session.config.secret=e,W.setSecret(e)):this.config.useSession=e,this},setSessionConfig:function(e,t,n){void 0===t?this.config.session.config=e:this.config.session=void 0!==n?{type:e,config:t,redisConfig:n}:{type:e};var r=this.config.session.config.secret;return void 0!==r&&W.setSecret(r),this},init:function(){if(!0===this.config.useSession){var e=this.config.session.config;if("redis"===this.config.session)e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({store:new(_()(U.a))({client:T.a.createClient(this.config.session.redisConfig)})},this.config.session.config);this.app.use(U()(e))}}},K=n(26),Q=n.n(K),V=n(5),X=n.n(V),Z=n(8),$=n.n(Z),ee=n(11),te=n.n(ee),ne=n(12),re=n.n(ne),oe=n(9),ie=n.n(oe),se=function(){function e(){s()(this,e),v()(this,"name",void 0),v()(this,"url",null),v()(this,"fields",{}),v()(this,"translatedFields",[]),v()(this,"createForm",null),v()(this,"editForm",null),v()(this,"softDeletable",!1),v()(this,"virtualFields",{}),v()(this,"links",{}),v()(this,"hooks",{})}return a()(e,[{key:"getFields",value:function(){var e=this,t={};return x.a.each(Object.keys(this.fields),(function(n){t[n]={type:e.fieldMapping(n),uniq:n.uniq}})),t}},{key:"build",value:function(e){return e.define(this.name,this.getFields(),{tableName:this.name})}},{key:"fieldMapping",value:function(e){switch(e.type){case"text":return X.a.STRING(void 0!==e.length?e.length:250);case"boolean":return X.a.BOOLEAN;case"datetime":return X.a.DATE;case"date":return X.a.DATEONLY;default:return X.a.STRING(void 0!==e.length?e.length:250)}}}]),e}();function ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ie()(e);if(t){var o=ie()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return re()(this,n)}}var ae=function(e){te()(n,e);var t=ue(n);function n(){var e;s()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),v()($()(e),"name","user"),v()($()(e),"url","users"),v()($()(e),"fields",{username:{type:"text",uniq:!0,length:250},password:{type:"text",length:500},token:{type:"text",length:500},acl:{type:"text",length:500},tokenExpiresAt:{type:"datetime",length:500},refreshToken:{type:"text",length:500},registrationToken:{type:"text",length:500},registrationTokenExpiresAt:{type:"datetime",length:500},registered:{type:"boolean"},active:{type:"boolean"}}),e}return n}(se);function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var le=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main",o=e.databases[r];if(void 0===o)throw new Error("Database '".concat(r,"' is not registered"));var i=o.models[n];if(void 0===i)throw new Error("Model '".concat(n,"' is not registered in database '").concat(r,"'"));var s=e.models[n],u=e.repositories[n],a=void 0!==u?u:c;return new a(t,i,s)};le.hasUrlModel=function(e){return void 0!==le.modelsUrl[e]},le.getUrlRepository=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";return le(e,le.modelsUrl[t],n)},le.databases={main:{database:null,models:{}}},le.modelsUrl={},le.models={user:ae},le.repositories={},le.addRepository=function(e,t){le.repositories[e]=t},le.getModel=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main";return le.databases[t].models[e]},le.getModelsInfo=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(x.a.each(e.models,(function(e){var t=(new e).name;le.models[t]=e})),!0===t)return Object.keys(le.models)},le.init=function(e){le.getModelsInfo(e,!1),le.databases.main.database=new X.a(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({dialect:"postgres"},e.config.database)),le.processModels("main"),le.databases.main.database.sync()},le.processModels=function(e){var t=le.databases[e].database;x.a.each(Object.keys(le.models),(function(n){var r=new le.models[n];le.modelsUrl[null!==r.url?r.url:n]=n,le.databases[e].models[n]=r.build(t)}))};var fe=le,he={setDatabaseConfig:function(e){return this.config.database=e,this},addModel:function(e){return this.models.push(e),this},addModels:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.models=[].concat(p()(this.models),t),this},init:function(){"object"===Q()(this.config.database)&&fe.init(this)}},pe=n(14),de=n.n(pe),ve=n(7),ye=n.n(ve),ge=n(10),be=n.n(ge),me=function(e){return new Error("Parameter '".concat(e,"' is required"))},ke=new(function(){function e(){var t=this;s()(this,e),v()(this,"pool",{ROLE_SUPER_ADMIN:{ROLE_ADMIN:{ROLE_USER:{ROLE_ANONYMOUS:{}}}}}),v()(this,"flatPool",{}),v()(this,"isGranted",function(){var e=be()(ye.a.mark((function e(n,r){var o,i,s,u,a,c=arguments;return ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=c.length>2&&void 0!==c[2]&&c[2],"ROLE_ANONYMOUS"!==r){e.next=3;break}return e.abrupt("return",!0);case 3:if(s=function(){return!0===(!0===i(n)&&!0===i(n.session)&&!0===i(n.session.user)&&void 0!==t.flatPool[n.session.user.acl]&&-1!==t.flatPool[n.session.user.acl].indexOf(r))},u=!0===(i=function(e){return-1===[null,void 0].indexOf(e)})(n)&&!0===i(n.get)?n.get("token"):null,!1!==i(u)&&!1!==o){e.next=8;break}return e.abrupt("return",s());case 8:return e.next=10,t.getUserByToken(n,u);case 10:return a=e.sent,n.session.user=null===a?void 0:a,e.abrupt("return",s());case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),v()(this,"getUserByToken",function(){var e=be()(ye.a.mark((function e(t,n){var r,o;return ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e,r){fe(t,"user").findOne({where:{token:n}}).then((function(t){if(console.log("DB ",n),console.log("DB USER",t),null===t)return r();e(t)})).catch((function(e){return r(e)}))})),e.prev=1,e.next=4,r;case 4:return o=e.sent,e.abrupt("return",o);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()),this.prepareHierarchy()}return a()(e,[{key:"setHierarchy",value:function(e){this.pool=e,this.prepareHierarchy()}},{key:"getPool",value:function(){return this.pool}},{key:"addRole",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me("roleName"),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===t)this.pool[e.toUpperCase()]={};else{if(void 0===this.pool[t.toUpperCase()])throw new Error("Role ".concat(t," was not found in hierarchy"));this.pool.ROLE_SUPER_ADMIN[e.toUpperCase()]={}}this.prepareHierarchy()}},{key:"prepareHierarchy",value:function(){var e=this;this.flatPool={};x.a.each(Object.keys(this.pool),(function(t){e.flatPool[t]=function t(n,r){var o=Object.keys(r),i=[n];return x.a.each(o,(function(n){var o=t(n,r[n]);e.flatPool[n]=o,i=[].concat(p()(i),p()(o))})),i}(t,e.pool[t])}))}}]),e}()),we=new(function(){function e(){s()(this,e),v()(this,"rooms",{}),v()(this,"actions",{}),v()(this,"roomAcls",{}),v()(this,"sockets",[])}return a()(e,[{key:"addSockets",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.sockets=[].concat(p()(this.sockets),t)}},{key:"addActions",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];x.a.each(t,(function(e){var t=de()(e,2),n=t[0],r=t[1];void 0===actions[n]&&(actions[n]={},x.a.each(Object.keys(r),(function(e){actions[n].message=r[e]})))}))}},{key:"getRoomType",value:function(e){if("string"==typeof e)return e;if(-1===[null,void 0].indexOf(e)&&"array"===e.constructor.name.toLowerCase()){var t=de()(e,2),n=t[0],r=t[1];return this.roomAcls[n]=r.toUpperCase(),n}return null}},{key:"init",value:function(e){var t=this;x.a.each(this.sockets,(function(n){var r=t.getRoomType(n);null!==r&&(t.rooms[r]=e.of("/socket_".concat(r.toLowerCase())),t.rooms[r].on("connection",(function(e){void 0!==t.roomAcls[r]||x.a.each(t.actions[r],(function(t){var n=de()(t,2),r=n[0],o=n[1];e.on(r,o)}))})))}))}}]),e}()),Oe={setSocketConfig:function(e){return this.config.socket=void 0===e?{}:e,this},useSocket:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.config.useSocket=e,this.config.useSessionSocket=t,this},addRooms:function(){return we.addSockets.apply(we,arguments),this},includeSockets:function(){return we.addActions.apply(we,arguments),this},initSocket:function(e){return we.init(e),this}},xe=function e(){s()(this,e),v()(this,"name",null),v()(this,"initializers",{}),v()(this,"routers",[]),v()(this,"publicPaths",[]),v()(this,"models",[]),v()(this,"socketRooms",[]),v()(this,"sockets",[]),v()(this,"acls",[])};function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ie()(e);if(t){var o=ie()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return re()(this,n)}}var Se=new(function(e){te()(n,e);var t=Pe(n);function n(){var e;s()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),v()($()(e),"modules",{}),e}return a()(n,[{key:"hasModule",value:function(e){return void 0!==this.modules[e]}},{key:"getModule",value:function(e){return this.modules[e]}},{key:"addModule",value:function(e,t){if(t.prototype instanceof xe==!1)throw new Error("Parameter must be a Module instance");var n=new t;this.modules[n.name]=n,this.merge(e,n)}}]),n}(function(){function e(){s()(this,e)}return a()(e,[{key:"merge",value:function(e,t){this.mergeInitializers(e,t).mergeModels(e,t).mergeRouters(e,t).mergePublic(e,t).mergeSocketRooms(e,t).mergeSockets(e,t).mergeAcls(e,t)}},{key:"mergeInitializers",value:function(e,t){var n=["constructor"];return x.a.each(Object.keys(t.initializers),(function(r){var o=t.initializers[r];"init"===r?e.inits.push(o):-1===n.indexOf(r)&&(e[r]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return o.call.apply(o,[e].concat(n))})})),this}},{key:"mergeRouters",value:function(e,t){return x.a.each(t.routers,(function(t){"array"===t.constructor.name.toLowerCase()?e.addRouter.apply(e,p()(t)):e.addRouter(t)})),this}},{key:"mergePublic",value:function(e,t){return x.a.each(t.publicPaths,(function(t){e.addPublic.apply(e,p()(t))})),this}},{key:"mergeModels",value:function(e,t){return e.addModels.apply(e,p()(t.models)),this}},{key:"mergeSocketRooms",value:function(e,t){return e.addRooms.apply(e,p()(t.socketRooms)),this}},{key:"mergeSockets",value:function(e,t){return this}},{key:"mergeAcls",value:function(e,t){return x.a.each(t.acls,(function(t){e.addAcl(t)})),this}}]),e}())),je=new(function(){function e(){s()(this,e),v()(this,"website",{})}return a()(e,[{key:"addWebsite",value:function(e){}}]),e}()),Ae={addWebsite:function(e){return je.addWebsite(e),this},addWebsites:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return x.a.each(n,(function(t){return e.addWebsite(t)})),this},addModule:function(e){return Se.addModule(this,e),this},addModules:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return x.a.each(n,(function(t){return e.addModule(t)})),this},getModule:function(e){return Se.getModule(e)},init:function(){}},Re={setAclHierarchy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me("hierarchy");return ke.setHierarchy(e),this},addAclRole:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me("roleName"),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return ke.addRole(e,t),this},init:function(){ke.prepareHierarchy()}};new(function(){function e(){s()(this,e),v()(this,"loginMethod",null)}return a()(e,[{key:"setLoginMethod",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null!==e&&"function"!=typeof e)throw new Error("Custom login method must be a function");this.loginMethod=e}},{key:"login",value:function(e,t){return new Promise((function(t,n){var r=e.username,o=e.password,i=function(e){return-1!==[null,void 0].indexOf(e)};if(!0===i(r)||!0===i(o))return n(new Error("Invalid login parameters"));var s=W(o);fe.getRepository(e,"user").findOne({where:{username:r,password:s,active:!0}}).then((function(e){if(null===e)return n(new Error("User was not found"));t(e)})).catch((function(e){return n(e)}))}))}}]),e}());function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){v()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qe=[C,J,he,Oe,Ae,Re];function Ce(){for(var e=this,t=["build"],n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];x.a.each(r,(function(n){x.a.each(Object.keys(n),(function(r){"init"===r?e.inits.push(n[r]):-1===t.indexOf(r)&&(e[r]=function(){for(var t,o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(t=n[r]).call.apply(t,[e].concat(i))})}))}))}var De=new(function(){function e(){s()(this,e),v()(this,"app",g()()),v()(this,"uses",[]),v()(this,"routers",[]),v()(this,"publicFolders",[]),v()(this,"models",[]),v()(this,"io",null),v()(this,"config",{customError:null,port:3e3,session:{type:null,config:{},redisConfig:void 0},socket:{}}),v()(this,"defaultConfig",{useCors:!1,statics:{},useSession:!1,useCompression:!0,useSocket:!1,useSessionSocket:!1}),v()(this,"inits",[]),Ce.call.apply(Ce,[this].concat(qe))}return a()(e,[{key:"run",value:function(){var e=this;this.config=Ee(Ee({},this.defaultConfig),this.config),this.app.set("trust proxy",1),x.a.each(this.inits,(function(t){t.call(e)})),this.app.use(w()("dev")),this.app.use(g.a.json()),this.use(g.a.urlencoded({extended:!1})),this.use(m()()),this.use(S()()),x.a.each(this.publicFolders,(function(t){1===t.length?e.app.use(g.a.static.apply(g.a,p()(t))):2===t.length&&e.app.use(t[0],g.a.static(t[1]))})),x.a.each(this.uses,(function(t){var n;(n=e.app).use.apply(n,p()(t))})),x.a.each(this.routers,(function(t){var n,r=f()(t),o=r[0],i=r.slice(1);(n=e.app)["router"===o?"use":o].apply(n,p()(i))})),null===this.config.customError&&this.app.use((function(e,t,n,r){n.status(e.status||500).json({valid:!1,error:e.message})})),M.call(this)}}]),e}()),Ue=new(function(){function e(){s()(this,e)}return a()(e,[{key:"get",value:function(e){return new Promise((function(e,t){return null}))}},{key:"set",value:function(e,t,n){}}]),e}()),Ne=new(function(){function e(){s()(this,e),v()(this,"pool",{})}return a()(e,[{key:"register",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];x.a.each(n,(function(t){var n=t.toUpperCase();void 0===e.pool[n]&&(e.pool[n]=[])}))}},{key:"subscribe",value:function(e,t){var n=e.toUpperCase();void 0===this.pool[n]&&(this.pool[n]=[]),this.pool[n].push(t)}},{key:"trigger",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=e.toUpperCase(),i=this.pool[o];void 0!==i&&x.a.each(i,(function(e){e.apply(void 0,n)}))}}]),e}()),Te=n(13),Ie=n.n(Te),_e=De,Le=c,Fe=function(e){return function(){var t=be()(ye.a.mark((function t(n,r,o){return ye.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ke.isGranted(n,e,!0);case 2:if(t.t0=t.sent,!0!==t.t0){t.next=5;break}return t.abrupt("return",o());case 5:return t.abrupt("return",o(Ie()(401,"You are not allowed to access this area")));case 6:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},Be=ke,He=Ue,ze=W,Ge=fe,We=Ne,Ye=we,Je=se,Ke=xe,Qe=Ie.a,Ve=g.a,Xe=Ve.Router}]));